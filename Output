(pyspark_env) vmadmin@ubuntu-vm:~$ spark-submit spark-streaming.py 
25/07/28 15:54:06 WARN Utils: Your hostname, ubuntu-vm resolves to a loopback address: 127.0.1.1; using 10.0.2.15 instead (on interface enp0s3)
25/07/28 15:54:06 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
25/07/28 15:54:10 INFO SparkContext: Running Spark version 3.5.1
25/07/28 15:54:10 INFO SparkContext: OS info Linux, 6.8.0-64-generic, amd64
25/07/28 15:54:10 INFO SparkContext: Java version 11.0.27
25/07/28 15:54:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/07/28 15:54:12 INFO ResourceUtils: ==============================================================
25/07/28 15:54:12 INFO ResourceUtils: No custom resources configured for spark.driver.
25/07/28 15:54:12 INFO ResourceUtils: ==============================================================
25/07/28 15:54:12 INFO SparkContext: Submitted application: RetailDataAnalysis
25/07/28 15:54:12 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/07/28 15:54:12 INFO ResourceProfile: Limiting resource is cpu
25/07/28 15:54:12 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/07/28 15:54:12 INFO SecurityManager: Changing view acls to: vmadmin
25/07/28 15:54:12 INFO SecurityManager: Changing modify acls to: vmadmin
25/07/28 15:54:12 INFO SecurityManager: Changing view acls groups to: 
25/07/28 15:54:13 INFO SecurityManager: Changing modify acls groups to: 
25/07/28 15:54:13 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: vmadmin; groups with view permissions: EMPTY; users with modify permissions: vmadmin; groups with modify permissions: EMPTY
25/07/28 15:54:15 INFO Utils: Successfully started service 'sparkDriver' on port 41301.
25/07/28 15:54:15 INFO SparkEnv: Registering MapOutputTracker
25/07/28 15:54:15 INFO SparkEnv: Registering BlockManagerMaster
25/07/28 15:54:16 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/07/28 15:54:16 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/07/28 15:54:16 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/07/28 15:54:16 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-caae4813-ea8a-42cd-9728-ac776961c0d0
25/07/28 15:54:16 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/07/28 15:54:16 INFO SparkEnv: Registering OutputCommitCoordinator
25/07/28 15:54:17 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/07/28 15:54:17 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/07/28 15:54:18 INFO Executor: Starting executor ID driver on host 10.0.2.15
25/07/28 15:54:18 INFO Executor: OS info Linux, 6.8.0-64-generic, amd64
25/07/28 15:54:18 INFO Executor: Java version 11.0.27
25/07/28 15:54:18 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/07/28 15:54:18 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@40b67848 for default.
25/07/28 15:54:19 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 33779.
25/07/28 15:54:19 INFO NettyBlockTransferService: Server created on 10.0.2.15:33779
25/07/28 15:54:19 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/07/28 15:54:19 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 10.0.2.15, 33779, None)
25/07/28 15:54:19 INFO BlockManagerMasterEndpoint: Registering block manager 10.0.2.15:33779 with 413.9 MiB RAM, BlockManagerId(driver, 10.0.2.15, 33779, None)
25/07/28 15:54:19 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 10.0.2.15, 33779, None)
25/07/28 15:54:19 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 10.0.2.15, 33779, None)
-------------------------------------------
Batch: 20
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565420208|United Kingdom|2025-07-28 06:58:10|273.37    |171        |1       |0        |
|154132565420209|United Kingdom|2025-07-28 06:58:12|35.62     |5          |1       |0        |
|154132565420210|United Kingdom|2025-07-28 06:58:13|136.79999 |40         |1       |0        |
|154132565420211|United Kingdom|2025-07-28 06:58:16|98.310005 |24         |1       |0        |
|154132565420212|United Kingdom|2025-07-28 06:58:22|16.95     |15         |1       |0        |
|154132565420213|Singapore     |2025-07-28 06:58:27|11.700001 |6          |1       |0        |
|154132565420214|United Kingdom|2025-07-28 06:58:29|1.25      |1          |1       |0        |
|154132565420215|United Kingdom|2025-07-28 06:58:31|59.3      |40         |1       |0        |
|154132565420216|United Kingdom|2025-07-28 06:58:35|19.650002 |9          |1       |0        |
|154132565420217|United Kingdom|2025-07-28 06:58:35|104.72    |20         |1       |0        |
|154132565420218|United Kingdom|2025-07-28 06:58:45|37.57     |20         |1       |0        |
|154132565420219|United Kingdom|2025-07-28 06:58:49|2.31      |1          |1       |0        |
|154132565420220|United Kingdom|2025-07-28 06:58:49|48.36     |74         |1       |0        |
|154132565420221|United Kingdom|2025-07-28 06:58:50|103.34    |75         |1       |0        |
|154132565420222|United Kingdom|2025-07-28 06:58:52|98.49     |46         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 21
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565420223|Germany       |2025-07-28 06:58:57|34.739998 |6          |1       |0        |
|154132565420224|United Kingdom|2025-07-28 06:58:57|4.13      |1          |1       |0        |
|154132565420225|United Kingdom|2025-07-28 06:59:01|7.7999997 |12         |1       |0        |
|154132565420226|United Kingdom|2025-07-28 06:59:09|0.79      |1          |1       |0        |
|154132565420227|United Kingdom|2025-07-28 06:59:11|15.72     |6          |1       |0        |
|154132565420228|United Kingdom|2025-07-28 06:59:13|3.7399998 |3          |1       |0        |
|154132565420229|United Kingdom|2025-07-28 06:59:19|501.9     |130        |1       |0        |
|154132565420230|United Kingdom|2025-07-28 06:59:21|39.6      |24         |1       |0        |
|154132565420231|United Kingdom|2025-07-28 06:59:27|8.64      |12         |1       |0        |
|154132565420232|United Kingdom|2025-07-28 06:59:29|5.1       |2          |1       |0        |
|154132565420233|United Kingdom|2025-07-28 06:59:29|15.7      |14         |1       |0        |
|154132565420234|United Kingdom|2025-07-28 06:59:34|17.7      |6          |1       |0        |
|154132565420235|United Kingdom|2025-07-28 06:59:42|82.2      |77         |1       |0        |
|154132565420236|United Kingdom|2025-07-28 06:59:43|43.62     |5          |1       |0        |
|154132565420237|United Kingdom|2025-07-28 06:59:46|26.98     |26         |1       |0        |
|154132565420238|United Kingdom|2025-07-28 06:59:50|134.28    |139        |1       |0        |
|154132565420239|United Kingdom|2025-07-28 06:59:57|43.03     |11         |1       |0        |
|154132565420240|United Kingdom|2025-07-28 06:59:59|12.4      |2          |1       |0        |
|154132565420241|United Kingdom|2025-07-28 07:00:00|57.99     |20         |1       |0        |
|154132565420242|United Kingdom|2025-07-28 07:00:11|4.95      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+
only showing top 20 rows

-------------------------------------------
Batch: 22
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425591|United Kingdom|2025-07-28 15:53:02|73.64     |12         |1       |0        |
|154132565425592|United Kingdom|2025-07-28 15:53:03|30.579998 |14         |1       |0        |
|154132565425593|United Kingdom|2025-07-28 15:53:05|87.94     |38         |1       |0        |
|154132565425594|United Kingdom|2025-07-28 15:53:05|16.95     |1          |1       |0        |
|154132565425595|United Kingdom|2025-07-28 15:53:07|4.98      |6          |1       |0        |
|154132565425596|United Kingdom|2025-07-28 15:53:19|47.25     |25         |1       |0        |
|154132565425597|United Kingdom|2025-07-28 15:53:25|11.360001 |7          |1       |0        |
|154132565425598|United Kingdom|2025-07-28 15:53:32|80.62     |15         |1       |0        |
|154132565425599|United Kingdom|2025-07-28 15:53:34|33.29     |17         |1       |0        |
|154132565425600|United Kingdom|2025-07-28 15:53:35|56.219997 |12         |1       |0        |
|154132565425601|United Kingdom|2025-07-28 15:53:38|14.849999 |3          |1       |0        |
|154132565425602|United Kingdom|2025-07-28 15:53:42|18.53     |3          |1       |0        |
|154132565425603|United Kingdom|2025-07-28 15:53:45|140.34999 |37         |1       |0        |
|154132565425604|United Kingdom|2025-07-28 15:53:46|88.8      |16         |1       |0        |
|154132565425605|United Kingdom|2025-07-28 15:53:50|1.65      |1          |1       |0        |
|154132565425606|United Kingdom|2025-07-28 15:53:55|51.68     |42         |1       |0        |
|154132565425607|United Kingdom|2025-07-28 15:54:00|682.96    |228        |1       |0        |
|154132565425608|United Kingdom|2025-07-28 15:54:01|1.25      |1          |1       |0        |
|154132565425609|United Kingdom|2025-07-28 15:54:09|113.22    |25         |1       |0        |
|154132565425610|United Kingdom|2025-07-28 15:54:11|17.95     |13         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+
only showing top 20 rows

-------------------------------------------
Batch: 23
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425635|United Kingdom|2025-07-28 15:56:06|-0.21     |1          |0       |1        |
|154132565425636|EIRE          |2025-07-28 15:56:07|74.25     |15         |1       |0        |
|154132565425637|United Kingdom|2025-07-28 15:56:32|15.87     |21         |1       |0        |
|154132565425638|United Kingdom|2025-07-28 15:56:48|116.78    |12         |1       |0        |
|154132565425639|United Kingdom|2025-07-28 15:56:49|123.0     |66         |1       |0        |
|154132565425640|United Kingdom|2025-07-28 15:56:56|72.45     |81         |1       |0        |
|154132565425641|United Kingdom|2025-07-28 15:57:04|4.52      |2          |1       |0        |
|154132565425642|United Kingdom|2025-07-28 15:57:05|2.75      |5          |1       |0        |
|154132565425643|United Kingdom|2025-07-28 15:57:17|130.04001 |65         |1       |0        |
|154132565425644|United Kingdom|2025-07-28 15:57:24|-267.06   |90         |0       |1        |
|154132565425645|United Kingdom|2025-07-28 15:57:27|1.25      |1          |1       |0        |
|154132565425646|United Kingdom|2025-07-28 15:57:30|30.0      |24         |1       |0        |
|154132565425647|United Kingdom|2025-07-28 15:57:35|21.460001 |26         |1       |0        |
|154132565425648|United Kingdom|2025-07-28 15:57:36|276.68    |42         |1       |0        |
|154132565425649|United Kingdom|2025-07-28 15:57:41|34.879997 |14         |1       |0        |
|154132565425650|United Kingdom|2025-07-28 15:57:44|52.16     |19         |1       |0        |
|154132565425651|United Kingdom|2025-07-28 15:57:46|72.52     |32         |1       |0        |
|154132565425652|Germany       |2025-07-28 15:57:49|14.26     |4          |1       |0        |
|154132565425653|United Kingdom|2025-07-28 15:57:54|26.4      |6          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 24
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425654|United Kingdom|2025-07-28 15:57:59|5.85      |5          |1       |0        |
|154132565425655|United Kingdom|2025-07-28 15:58:03|22.5      |14         |1       |0        |
|154132565425656|United Kingdom|2025-07-28 15:58:10|84.15     |20         |1       |0        |
|154132565425657|United Kingdom|2025-07-28 15:58:19|5.01      |3          |1       |0        |
|154132565425658|United Kingdom|2025-07-28 15:58:19|134.22    |62         |1       |0        |
|154132565425659|United Kingdom|2025-07-28 15:58:23|41.300003 |10         |1       |0        |
|154132565425660|United Kingdom|2025-07-28 15:58:37|2.55      |1          |1       |0        |
|154132565425661|United Kingdom|2025-07-28 15:58:47|1.25      |1          |1       |0        |
|154132565425662|United Kingdom|2025-07-28 15:58:47|39.96     |12         |1       |0        |
|154132565425663|United Kingdom|2025-07-28 15:58:53|68.36     |20         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 25
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425664|United Kingdom|2025-07-28 15:58:56|25.85     |15         |1       |0        |
|154132565425665|United Kingdom|2025-07-28 15:58:56|-347.06998|57         |0       |1        |
|154132565425666|United Kingdom|2025-07-28 15:59:00|8.26      |2          |1       |0        |
|154132565425667|United Kingdom|2025-07-28 15:59:10|1.66      |2          |1       |0        |
|154132565425668|United Kingdom|2025-07-28 15:59:13|135.2     |82         |1       |0        |
|154132565425669|United Kingdom|2025-07-28 15:59:14|19.199999 |29         |1       |0        |
|154132565425670|United Kingdom|2025-07-28 15:59:17|16.53     |4          |1       |0        |
|154132565425671|United Kingdom|2025-07-28 15:59:17|50.31     |57         |1       |0        |
|154132565425672|United Kingdom|2025-07-28 15:59:25|75.46     |33         |1       |0        |
|154132565425673|United Kingdom|2025-07-28 15:59:33|729.65    |257        |1       |0        |
|154132565425674|United Kingdom|2025-07-28 15:59:40|113.76    |44         |1       |0        |
|154132565425675|Cyprus        |2025-07-28 15:59:43|16.5      |10         |1       |0        |
|154132565425676|United Kingdom|2025-07-28 15:59:44|162.36    |36         |1       |0        |
|154132565425677|United Kingdom|2025-07-28 15:59:47|31.08     |36         |1       |0        |
|154132565425678|United Kingdom|2025-07-28 15:59:53|136.53    |47         |1       |0        |
|154132565425679|United Kingdom|2025-07-28 15:59:54|67.54     |26         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 26
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425680|United Kingdom|2025-07-28 16:00:00|80.18     |18         |1       |0        |
|154132565425681|EIRE          |2025-07-28 16:00:02|5.1000004 |6          |1       |0        |
|154132565425682|United Kingdom|2025-07-28 16:00:03|2.9499998 |2          |1       |0        |
|154132565425683|United Kingdom|2025-07-28 16:00:11|31.75     |17         |1       |0        |
|154132565425684|United Kingdom|2025-07-28 16:00:17|134.0     |38         |1       |0        |
|154132565425685|United Kingdom|2025-07-28 16:00:22|1.25      |1          |1       |0        |
|154132565425686|United Kingdom|2025-07-28 16:00:38|42.48     |36         |1       |0        |
|154132565425687|France        |2025-07-28 16:00:38|62.65     |33         |1       |0        |
|154132565425688|United Kingdom|2025-07-28 16:00:40|15.06     |8          |1       |0        |
|154132565425689|Norway        |2025-07-28 16:00:47|136.49    |19         |1       |0        |
|154132565425690|United Kingdom|2025-07-28 16:00:53|196.8     |37         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 27
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425691|United Kingdom|2025-07-28 16:01:20|8.5       |2          |1       |0        |
|154132565425692|United Kingdom|2025-07-28 16:01:28|1161.0    |757        |1       |0        |
|154132565425693|United Kingdom|2025-07-28 16:01:35|25.2      |16         |1       |0        |
|154132565425694|United Kingdom|2025-07-28 16:01:36|298.5     |123        |1       |0        |
|154132565425695|United Kingdom|2025-07-28 16:01:38|15.25     |5          |1       |0        |
|154132565425696|United Kingdom|2025-07-28 16:01:45|74.38     |26         |1       |0        |
|154132565425697|United Kingdom|2025-07-28 16:01:50|179.96    |102        |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 28
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425698|Iceland       |2025-07-28 16:02:00|107.85    |29         |1       |0        |
|154132565425699|United Kingdom|2025-07-28 16:02:00|52.890003 |15         |1       |0        |
|154132565425700|Canada        |2025-07-28 16:02:00|184.03    |90         |1       |0        |
|154132565425701|United Kingdom|2025-07-28 16:02:09|60.08     |10         |1       |0        |
|154132565425702|United Kingdom|2025-07-28 16:02:15|35.5      |10         |1       |0        |
|154132565425703|United Kingdom|2025-07-28 16:02:18|3.58      |2          |1       |0        |
|154132565425704|United Kingdom|2025-07-28 16:02:27|35.4      |20         |1       |0        |
|154132565425705|United Kingdom|2025-07-28 16:02:27|1815.13   |149        |1       |0        |
|154132565425706|United Kingdom|2025-07-28 16:02:45|9.78      |6          |1       |0        |
|154132565425707|United Kingdom|2025-07-28 16:02:46|1.7       |2          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 29
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425708|United Kingdom|2025-07-28 16:02:52|41.86     |33         |1       |0        |
|154132565425709|United Kingdom|2025-07-28 16:02:59|20.24     |4          |1       |0        |
|154132565425710|Portugal      |2025-07-28 16:03:02|71.54     |40         |1       |0        |
|154132565425711|United Kingdom|2025-07-28 16:03:07|267.27    |64         |1       |0        |
|154132565425712|United Kingdom|2025-07-28 16:03:09|41.41     |5          |1       |0        |
|154132565425713|United Kingdom|2025-07-28 16:03:10|16.5      |2          |1       |0        |
|154132565425714|United Kingdom|2025-07-28 16:03:12|0.83      |1          |1       |0        |
|154132565425715|United Kingdom|2025-07-28 16:03:20|19.8      |4          |1       |0        |
|154132565425716|United Kingdom|2025-07-28 16:03:23|112.07    |41         |1       |0        |
|154132565425717|United Kingdom|2025-07-28 16:03:35|45.76     |22         |1       |0        |
|154132565425718|United Kingdom|2025-07-28 16:03:47|44.12     |12         |1       |0        |
|154132565425719|United Kingdom|2025-07-28 16:03:47|75.270004 |19         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 30
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425720|France        |2025-07-28 16:03:53|8.35      |3          |1       |0        |
|154132565425721|United Kingdom|2025-07-28 16:03:58|189.09    |49         |1       |0        |
|154132565425722|United Kingdom|2025-07-28 16:04:00|19.07     |7          |1       |0        |
|154132565425723|United Kingdom|2025-07-28 16:04:00|208.69    |109        |1       |0        |
|154132565425724|United Kingdom|2025-07-28 16:04:01|25.26     |31         |1       |0        |
|154132565425725|United Kingdom|2025-07-28 16:04:05|-18.36    |13         |0       |1        |
|154132565425726|United Kingdom|2025-07-28 16:04:09|25.24     |19         |1       |0        |
|154132565425727|France        |2025-07-28 16:04:12|40.8      |24         |1       |0        |
|154132565425728|Switzerland   |2025-07-28 16:04:15|69.229996 |27         |1       |0        |
|154132565425729|United Kingdom|2025-07-28 16:04:20|2.5       |2          |1       |0        |
|154132565425730|United Kingdom|2025-07-28 16:04:25|85.049995 |15         |1       |0        |
|154132565425731|United Kingdom|2025-07-28 16:04:29|62.03     |24         |1       |0        |
|154132565425732|United Kingdom|2025-07-28 16:04:35|223.07    |178        |1       |0        |
|154132565425733|United Kingdom|2025-07-28 16:04:39|25.3      |26         |1       |0        |
|154132565425734|United Kingdom|2025-07-28 16:04:47|0.83      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 31
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425735|United Kingdom|2025-07-28 16:04:53|54.350002 |19         |1       |0        |
|154132565425736|Netherlands   |2025-07-28 16:04:53|-264.24   |109        |0       |1        |
|154132565425737|United Kingdom|2025-07-28 16:05:05|0.65      |1          |1       |0        |
|154132565425738|United Kingdom|2025-07-28 16:05:10|430.09    |77         |1       |0        |
|154132565425739|United Kingdom|2025-07-28 16:05:11|25.199999 |60         |1       |0        |
|154132565425740|United Kingdom|2025-07-28 16:05:17|22.69     |15         |1       |0        |
|154132565425741|United Kingdom|2025-07-28 16:05:19|31.4      |20         |1       |0        |
|154132565425742|United Kingdom|2025-07-28 16:05:34|17.779999 |4          |1       |0        |
|154132565425743|Italy         |2025-07-28 16:05:40|71.18     |42         |1       |0        |
|154132565425744|United Kingdom|2025-07-28 16:05:41|712.37    |336        |1       |0        |
|154132565425745|United Kingdom|2025-07-28 16:05:42|73.24     |30         |1       |0        |
|154132565425746|United Kingdom|2025-07-28 16:05:50|2.1       |1          |1       |0        |
|154132565425747|United Kingdom|2025-07-28 16:06:04|-18.4     |16         |0       |1        |
|154132565425748|United Kingdom|2025-07-28 16:06:07|20.76     |5          |1       |0        |
|154132565425749|United Kingdom|2025-07-28 16:06:09|41.5      |7          |1       |0        |
|154132565425750|United Kingdom|2025-07-28 16:06:14|17.7      |6          |1       |0        |
|154132565425751|United Kingdom|2025-07-28 16:06:17|46.25     |23         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 32
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425752|United Kingdom|2025-07-28 16:06:50|0.42      |1          |1       |0        |
|154132565425753|EIRE          |2025-07-28 16:07:00|163.29    |44         |1       |0        |
|154132565425754|United Kingdom|2025-07-28 16:07:04|15.0      |4          |1       |0        |
|154132565425755|United Kingdom|2025-07-28 16:07:10|12.5      |10         |1       |0        |
|154132565425756|United Kingdom|2025-07-28 16:07:12|5.04      |12         |1       |0        |
|154132565425757|United Kingdom|2025-07-28 16:07:15|17.51     |5          |1       |0        |
|154132565425758|Switzerland   |2025-07-28 16:07:15|209.15    |91         |1       |0        |
|154132565425759|United Kingdom|2025-07-28 16:07:19|89.68     |30         |1       |0        |
|154132565425760|United Kingdom|2025-07-28 16:07:32|60.219997 |20         |1       |0        |
|154132565425761|United Kingdom|2025-07-28 16:07:33|25.66     |17         |1       |0        |
|154132565425762|United Kingdom|2025-07-28 16:07:45|50.399998 |72         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 33
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425763|United Kingdom|2025-07-28 16:07:55|144.86    |42         |1       |0        |
|154132565425764|United Kingdom|2025-07-28 16:08:03|180.79    |74         |1       |0        |
|154132565425765|United Kingdom|2025-07-28 16:08:13|45.56     |15         |1       |0        |
|154132565425766|EIRE          |2025-07-28 16:08:25|719.38995 |123        |1       |0        |
|154132565425767|United Kingdom|2025-07-28 16:08:33|363.72    |76         |1       |0        |
|154132565425768|United Kingdom|2025-07-28 16:08:44|-38.56    |25         |0       |1        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 34
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425769|United Kingdom|2025-07-28 16:08:48|79.06     |31         |1       |0        |
|154132565425770|United Kingdom|2025-07-28 16:09:00|2.46      |1          |1       |0        |
|154132565425771|United Kingdom|2025-07-28 16:09:01|14.650001 |7          |1       |0        |
|154132565425772|United Kingdom|2025-07-28 16:09:03|29.52     |12         |1       |0        |
|154132565425773|United Kingdom|2025-07-28 16:09:09|31.73     |20         |1       |0        |
|154132565425774|United Kingdom|2025-07-28 16:09:13|50.149998 |40         |1       |0        |
|154132565425775|United Kingdom|2025-07-28 16:09:14|1.25      |1          |1       |0        |
|154132565425776|United Kingdom|2025-07-28 16:09:19|4.25      |1          |1       |0        |
|154132565425777|United Kingdom|2025-07-28 16:09:20|15.0      |12         |1       |0        |
|154132565425778|United Kingdom|2025-07-28 16:09:22|11.58     |2          |1       |0        |
|154132565425779|United Kingdom|2025-07-28 16:09:23|26.849998 |6          |1       |0        |
|154132565425780|United Kingdom|2025-07-28 16:09:26|87.31     |56         |1       |0        |
|154132565425781|United Kingdom|2025-07-28 16:09:27|31.6      |16         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 35
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425782|United Kingdom|2025-07-28 16:09:46|-34.510002|17         |0       |1        |
|154132565425783|United Kingdom|2025-07-28 16:10:00|17.75     |21         |1       |0        |
|154132565425784|United Kingdom|2025-07-28 16:10:17|46.1      |16         |1       |0        |
|154132565425785|United Kingdom|2025-07-28 16:10:24|2.5       |25         |1       |0        |
|154132565425786|United Kingdom|2025-07-28 16:10:36|64.55     |13         |1       |0        |
|154132565425787|United Kingdom|2025-07-28 16:10:39|37.850002 |13         |1       |0        |
|154132565425788|United Kingdom|2025-07-28 16:10:42|54.12     |48         |1       |0        |
|154132565425789|United Kingdom|2025-07-28 16:10:51|7.18      |14         |1       |0        |
|154132565425790|United Kingdom|2025-07-28 16:10:51|21.5      |8          |1       |0        |
|154132565425791|United Kingdom|2025-07-28 16:10:58|41.850002 |39         |1       |0        |
|154132565425792|United Kingdom|2025-07-28 16:11:05|40.7      |22         |1       |0        |
|154132565425793|United Kingdom|2025-07-28 16:11:07|22.09     |17         |1       |0        |
|154132565425794|United Kingdom|2025-07-28 16:11:09|14.65     |26         |1       |0        |
|154132565425795|United Kingdom|2025-07-28 16:11:17|22.5      |6          |1       |0        |
|154132565425796|United Kingdom|2025-07-28 16:11:18|25.39     |19         |1       |0        |
|154132565425797|United Kingdom|2025-07-28 16:11:20|3.55      |2          |1       |0        |
|154132565425798|United Kingdom|2025-07-28 16:11:23|41.46     |34         |1       |0        |
|154132565425799|United Kingdom|2025-07-28 16:11:26|5.79      |3          |1       |0        |
|154132565425800|United Kingdom|2025-07-28 16:11:29|81.42     |122        |1       |0        |
|154132565425801|United Kingdom|2025-07-28 16:11:32|30.59     |13         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+
only showing top 20 rows

-------------------------------------------
Batch: 36
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425804|EIRE          |2025-07-28 16:11:59|157.2     |92         |1       |0        |
|154132565425805|United Kingdom|2025-07-28 16:12:00|41.6      |20         |1       |0        |
|154132565425806|United Kingdom|2025-07-28 16:12:10|21.039999 |6          |1       |0        |
|154132565425807|United Kingdom|2025-07-28 16:12:16|141.56    |105        |1       |0        |
|154132565425808|United Kingdom|2025-07-28 16:12:29|89.66     |85         |1       |0        |
|154132565425809|United Kingdom|2025-07-28 16:12:31|90.56     |42         |1       |0        |
|154132565425810|United Kingdom|2025-07-28 16:12:35|42.47     |31         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 37
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425811|United Kingdom|2025-07-28 16:12:51|61.01     |50         |1       |0        |
|154132565425812|United Kingdom|2025-07-28 16:13:05|7.54      |14         |1       |0        |
|154132565425813|United Kingdom|2025-07-28 16:13:08|99.19     |37         |1       |0        |
|154132565425814|United Kingdom|2025-07-28 16:13:15|92.659996 |35         |1       |0        |
|154132565425815|United Kingdom|2025-07-28 16:13:16|34.06     |16         |1       |0        |
|154132565425816|United Kingdom|2025-07-28 16:13:20|15.0      |12         |1       |0        |
|154132565425817|United Kingdom|2025-07-28 16:13:21|49.7      |22         |1       |0        |
|154132565425818|United Kingdom|2025-07-28 16:13:21|41.85     |15         |1       |0        |
|154132565425819|United Kingdom|2025-07-28 16:13:21|95.69     |57         |1       |0        |
|154132565425820|United Kingdom|2025-07-28 16:13:22|8.5       |1          |1       |0        |
|154132565425821|United Kingdom|2025-07-28 16:13:22|69.1      |40         |1       |0        |
|154132565425822|United Kingdom|2025-07-28 16:13:23|159.94    |19         |1       |0        |
|154132565425823|United Kingdom|2025-07-28 16:13:24|14.059999 |5          |1       |0        |
|154132565425824|United Kingdom|2025-07-28 16:13:26|1.65      |1          |1       |0        |
|154132565425825|United Kingdom|2025-07-28 16:13:27|119.91    |51         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 38
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425826|Finland       |2025-07-28 16:13:41|23.939999 |29         |1       |0        |
|154132565425827|United Kingdom|2025-07-28 16:13:46|15.0      |4          |1       |0        |
|154132565425828|United Kingdom|2025-07-28 16:13:48|55.27     |10         |1       |0        |
|154132565425829|United Kingdom|2025-07-28 16:13:51|30.48     |28         |1       |0        |
|154132565425830|United Kingdom|2025-07-28 16:13:51|89.909996 |80         |1       |0        |
|154132565425831|EIRE          |2025-07-28 16:13:52|45.16     |14         |1       |0        |
|154132565425832|United Kingdom|2025-07-28 16:13:57|370.9     |186        |1       |0        |
|154132565425833|United Kingdom|2025-07-28 16:14:07|76.090004 |23         |1       |0        |
|154132565425834|United Kingdom|2025-07-28 16:14:11|108.85    |73         |1       |0        |
|154132565425835|United Kingdom|2025-07-28 16:14:19|0.39      |1          |1       |0        |
|154132565425836|United Kingdom|2025-07-28 16:14:27|44.86     |16         |1       |0        |
|154132565425837|United Kingdom|2025-07-28 16:14:28|187.29999 |73         |1       |0        |
|154132565425838|United Kingdom|2025-07-28 16:14:36|345.83    |121        |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 39
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425839|United Kingdom|2025-07-28 16:14:44|31.17     |21         |1       |0        |
|154132565425840|United Kingdom|2025-07-28 16:14:44|4.96      |2          |1       |0        |
|154132565425841|United Kingdom|2025-07-28 16:14:46|29.5      |10         |1       |0        |
|154132565425842|United Kingdom|2025-07-28 16:14:49|35.21     |3          |1       |0        |
|154132565425843|United Kingdom|2025-07-28 16:15:04|3.3       |2          |1       |0        |
|154132565425844|United Kingdom|2025-07-28 16:15:16|-150.0    |43         |0       |1        |
|154132565425845|United Kingdom|2025-07-28 16:15:18|40.85     |15         |1       |0        |
|154132565425846|United Kingdom|2025-07-28 16:15:21|118.5     |58         |1       |0        |
|154132565425847|United Kingdom|2025-07-28 16:15:29|25.92     |11         |1       |0        |
|154132565425848|United Kingdom|2025-07-28 16:15:30|4.9       |2          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 40
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425849|United Kingdom|2025-07-28 16:15:40|20.54     |9          |1       |0        |
|154132565425850|United Kingdom|2025-07-28 16:15:44|27.38     |12         |1       |0        |
|154132565425851|United Kingdom|2025-07-28 16:15:49|113.770004|50         |1       |0        |
|154132565425852|United Kingdom|2025-07-28 16:15:51|3.3       |2          |1       |0        |
|154132565425853|United Kingdom|2025-07-28 16:16:00|123.36    |56         |1       |0        |
|154132565425854|United Kingdom|2025-07-28 16:16:02|50.78     |11         |1       |0        |
|154132565425855|United Kingdom|2025-07-28 16:16:03|197.9     |34         |1       |0        |
|154132565425856|United Kingdom|2025-07-28 16:16:11|13.85     |7          |1       |0        |
|154132565425857|Spain         |2025-07-28 16:16:21|101.509995|21         |1       |0        |
|154132565425858|United Kingdom|2025-07-28 16:16:22|19.1      |3          |1       |0        |
|154132565425859|United Kingdom|2025-07-28 16:16:25|23.68     |49         |1       |0        |
|154132565425860|Germany       |2025-07-28 16:16:34|315.8     |138        |1       |0        |
|154132565425861|United Kingdom|2025-07-28 16:16:35|47.85     |62         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 41
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425862|United Kingdom|2025-07-28 16:16:52|167.39    |130        |1       |0        |
|154132565425863|United Kingdom|2025-07-28 16:16:55|0.65      |1          |1       |0        |
|154132565425864|United Kingdom|2025-07-28 16:17:03|38.36     |12         |1       |0        |
|154132565425865|United Kingdom|2025-07-28 16:17:04|35.98     |19         |1       |0        |
|154132565425866|Hong Kong     |2025-07-28 16:17:07|50.899998 |30         |1       |0        |
|154132565425867|United Kingdom|2025-07-28 16:17:12|38.420002 |14         |1       |0        |
|154132565425868|EIRE          |2025-07-28 16:17:15|-166.08   |40         |0       |1        |
|154132565425869|United Kingdom|2025-07-28 16:17:32|34.739998 |6          |1       |0        |
|154132565425870|United Kingdom|2025-07-28 16:17:34|39.78     |6          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 42
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425871|United Kingdom|2025-07-28 16:17:43|30.33     |17         |1       |0        |
|154132565425872|United Kingdom|2025-07-28 16:17:45|44.43     |13         |1       |0        |
|154132565425873|Belgium       |2025-07-28 16:17:50|27.859999 |14         |1       |0        |
|154132565425874|United Kingdom|2025-07-28 16:17:50|20.76     |7          |1       |0        |
|154132565425875|United Kingdom|2025-07-28 16:17:53|42.72     |14         |1       |0        |
|154132565425876|United Kingdom|2025-07-28 16:17:57|1.79      |1          |1       |0        |
|154132565425877|United Kingdom|2025-07-28 16:18:14|59.93     |35         |1       |0        |
|154132565425878|United Kingdom|2025-07-28 16:18:25|539.87    |323        |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 43
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425879|United Kingdom|2025-07-28 16:18:56|28.5      |26         |1       |0        |
|154132565425880|United Kingdom|2025-07-28 16:19:10|34.64     |22         |1       |0        |
|154132565425881|Germany       |2025-07-28 16:19:33|15.42     |13         |1       |0        |
|154132565425882|United Kingdom|2025-07-28 16:19:35|15.0      |12         |1       |0        |
|154132565425883|United Kingdom|2025-07-28 16:19:48|25.08     |9          |1       |0        |
|154132565425884|United Kingdom|2025-07-28 16:19:55|3.34      |4          |1       |0        |
|154132565425885|United Kingdom|2025-07-28 16:20:03|42.86     |30         |1       |0        |
|154132565425886|United Kingdom|2025-07-28 16:20:06|50.95     |9          |1       |0        |
|154132565425887|United Kingdom|2025-07-28 16:20:09|74.04     |93         |1       |0        |
|154132565425888|United Kingdom|2025-07-28 16:20:33|306.0     |36         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 44
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425889|United Kingdom|2025-07-28 16:20:35|65.45     |29         |1       |0        |
|154132565425890|United Kingdom|2025-07-28 16:20:38|127.03    |40         |1       |0        |
|154132565425891|United Kingdom|2025-07-28 16:20:50|8.4       |4          |1       |0        |
|154132565425892|United Kingdom|2025-07-28 16:20:57|244.92    |99         |1       |0        |
|154132565425893|United Kingdom|2025-07-28 16:21:02|80.729996 |48         |1       |0        |
|154132565425894|United Kingdom|2025-07-28 16:21:21|37.25     |7          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 45
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132565425895|United Kingdom|2025-07-28 16:21:36|126.82    |40         |1       |0        |
|154132565425896|United Kingdom|2025-07-28 16:21:42|24.32     |19         |1       |0        |
|154132565425897|United Kingdom|2025-07-28 16:21:49|51.14     |37         |1       |0        |
|154132565425898|United Kingdom|2025-07-28 16:22:17|50.12     |36         |1       |0        |
|154132565425899|United Kingdom|2025-07-28 16:22:23|19.039999 |40         |1       |0        |
|154132565425900|United Kingdom|2025-07-28 16:22:27|142.5     |161        |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+





